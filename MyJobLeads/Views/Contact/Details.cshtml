@model Contact
@using MyJobLeads.DomainModel.Entities;

@{
    ViewBag.Title = "Contact: " + Model.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Sidebar = Html.Partial(MVC.Company.Views._CompanySidebarDisplay, Model.Company);

    string taskString = Model.Tasks.Count == 1 ? "task" : "tasks";
}

<h2>@Model.Name's Details</h2>

<p>
    @Model.Name is a contact for @Html.ActionLink(Model.Company.Name, MVC.Company.Details(Model.Company.Id)) <br /><br />
    Direct Phone: @Model.DirectPhone @if (!string.IsNullOrWhiteSpace(Model.Extension)) { <text>Ext: @Model.Extension</text> } <br />
    Mobile Phone: @Model.MobilePhone <br />
    Email Address: <a href="mailto:@Model.Email">@Model.Email</a> <br />
    Assistant: @Model.Assistant <br />
    Referred By: @Model.ReferredBy <br />
    Notes: @Html.Raw(Html.Encode(Model.Notes).Replace(Environment.NewLine, "<br />"))
</p>

@Html.ActionLink("Edit Contact Details", MVC.Contact.Edit(Model.Id))

<br /><br />
<h2>Tasks</h2>
This contact has @Model.Tasks.Count @taskString entered 
(@Html.ActionLink("Add", MVC.Task.Add((int)Model.CompanyId, Model.Id)))

<ul>
    @foreach (Task task in Model.Tasks)
    {
        <li>
            @Html.ActionLink(task.Name, MVC.Task.Details(task.Id)) - 

            @if (task.Completed) { <text>Completed </text> }
            else { <b>Not Completed</b> }

            @if (task.TaskDate != null && !task.Completed) { <text> - Due: @task.TaskDate.Value.ToString()</text> }
        </li>
    }
</ul>